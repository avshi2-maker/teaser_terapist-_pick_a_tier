<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>â˜¯ MERIDIAN</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Heebo:wght@300;400;600;700;900&family=Abril+Fatface&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{
  --jade:#0d5c45;--jade2:#1a8a65;--gold:#c9a84c;--gold2:#e8c96e;
  --bg:#e8f5e9;--cream:#f0ece0;--dark:#0a1a0a;
  --red:#e74c3c;--green:#27ae60;
  --card:rgba(255,255,255,0.94);--shadow:0 4px 20px rgba(0,0,0,0.08);
}
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;overflow:hidden;font-family:'Heebo',sans-serif;background:var(--bg);}

/* NAVBAR */
.nav{position:fixed;top:0;left:0;right:0;z-index:200;height:46px;
  background:rgba(13,92,69,0.97);backdrop-filter:blur(12px);
  border-bottom:1px solid rgba(201,168,76,0.2);
  display:flex;align-items:center;justify-content:space-between;padding:0 16px;}
.nav-brand{font-family:'Cinzel',serif;font-size:14px;letter-spacing:3px;color:var(--gold2);}
.nav-r{display:flex;align-items:center;gap:12px;}
.nav-step{font-size:10px;letter-spacing:1px;color:rgba(201,168,76,0.55);}
.nav-clock{font-family:'JetBrains Mono',monospace;font-size:14px;color:var(--gold2);
  background:rgba(0,0,0,0.25);padding:3px 10px;border-radius:6px;letter-spacing:2px;}

/* SCREENS */
.screen{display:none;position:fixed;top:46px;left:0;right:0;bottom:0;overflow:hidden;}
.screen.active{display:flex;flex-direction:column;}

/* â”€â”€ S0 TEASER â”€â”€ */
#s0{
  background-image:url('https://iqfglrwjemogoycbzltt.supabase.co/storage/v1/object/sign/images/clinickey.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wYzMwY2Y5MC1kYTY5LTRhNzgtYTAyYi1kNmZkNTA2NDc3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJpbWFnZXMvY2xpbmlja2V5LnBuZyIsImlhdCI6MTc3MjExMzU3NSwiZXhwIjozMzQ4OTEzNTc1fQ.ljErkcsh4NNeDiFnuWmaLa_IeWxKY0KGy0qYE-zo10o'),
    linear-gradient(135deg,#0a2e1a,#0d5c45 50%,#0a1a0a);
  background-size:cover;background-position:center;}
#s0::before{content:'';position:absolute;inset:0;
  background:linear-gradient(to bottom,rgba(10,14,10,0.45),rgba(10,14,10,0.78));z-index:0;}
.s0-body{position:relative;z-index:1;display:flex;flex-direction:column;
  align-items:center;justify-content:center;height:100%;padding:20px;text-align:center;}
.s0-eye{font-family:'Cinzel',serif;font-size:10px;letter-spacing:5px;color:var(--gold2);margin-bottom:10px;}
.s0-ttl{font-family:'Abril Fatface',serif;font-size:clamp(30px,6vw,56px);
  color:var(--cream);line-height:1.1;margin-bottom:8px;text-shadow:0 3px 16px rgba(0,0,0,0.5);}
.s0-sub{font-size:clamp(12px,2vw,15px);color:rgba(240,236,224,0.82);
  margin-bottom:18px;line-height:1.65;max-width:520px;}
.s0-badges{display:flex;gap:7px;justify-content:center;flex-wrap:wrap;margin-bottom:22px;}
.s0-badge{background:rgba(201,168,76,0.14);border:1px solid rgba(201,168,76,0.3);
  border-radius:50px;padding:4px 13px;font-size:11px;color:var(--gold2);font-weight:600;}
.s0-btn{padding:14px 38px;border-radius:50px;border:none;cursor:pointer;
  background:linear-gradient(135deg,var(--jade),var(--jade2));color:var(--gold2);
  font-family:'Cinzel',serif;font-size:13px;font-weight:700;letter-spacing:2px;
  box-shadow:0 6px 24px rgba(13,92,69,0.5);transition:all .3s;}
.s0-btn:hover{transform:translateY(-2px);}

/* â”€â”€ S1 REGISTER + WA â”€â”€ */
#s1{background:var(--bg);padding:14px;}
.s1-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;
  height:100%;max-width:860px;margin:0 auto;}
@media(max-width:620px){.s1-grid{grid-template-columns:1fr;overflow:auto;}}

.card{background:var(--card);border-radius:14px;padding:16px 18px;
  box-shadow:var(--shadow);border:1px solid rgba(13,92,69,0.09);
  display:flex;flex-direction:column;overflow:hidden;}
.c-ttl{font-family:'Cinzel',serif;font-size:13px;letter-spacing:1.5px;color:var(--jade);margin-bottom:3px;}
.c-sub{font-size:11px;color:#777;margin-bottom:10px;}
.fg2{display:grid;grid-template-columns:1fr 1fr;gap:8px;flex:1;}
.field{display:flex;flex-direction:column;gap:3px;}
.field.full{grid-column:1/-1;}
.flbl{font-size:9px;font-weight:700;letter-spacing:1px;color:#555;text-transform:uppercase;}
.finp,.fsel{padding:8px 10px;border-radius:7px;font-size:13px;font-family:'Heebo',sans-serif;
  border:1.5px solid rgba(0,0,0,0.1);background:white;color:#1a2e1a;outline:none;transition:border-color .2s;}
.finp:focus,.fsel:focus{border-color:var(--jade2);}
.ferr{font-size:10px;color:var(--red);display:none;}
.ferr.show{display:block;}

.wa-card{background:var(--card);border-radius:14px;padding:16px 18px;
  box-shadow:var(--shadow);border:1px solid rgba(13,92,69,0.09);
  display:flex;flex-direction:column;align-items:center;gap:10px;text-align:center;}
.wa-icon{font-size:44px;}
.wa-ttl{font-family:'Cinzel',serif;font-size:14px;color:var(--jade);}
.wa-desc{font-size:11px;color:#666;line-height:1.65;max-width:240px;}
.wa-prev{background:#f0faf0;border:1px solid rgba(37,211,102,0.25);
  border-radius:10px;padding:10px 13px;font-size:11px;color:#333;
  line-height:1.85;text-align:right;width:100%;white-space:pre-wrap;min-height:90px;flex:1;}
.wa-btn{display:flex;align-items:center;justify-content:center;gap:8px;
  width:100%;padding:12px;border-radius:10px;border:none;cursor:pointer;
  background:#25d366;color:white;font-family:'Cinzel',serif;
  font-size:12px;font-weight:700;letter-spacing:1px;
  box-shadow:0 4px 14px rgba(37,211,102,0.35);transition:all .2s;}
.wa-btn:hover{transform:translateY(-1px);}
.wa-btn:disabled{background:#bbb;box-shadow:none;cursor:not-allowed;transform:none;}
.cont-btn{width:100%;padding:12px;border-radius:10px;border:none;cursor:pointer;
  background:linear-gradient(135deg,var(--jade),var(--jade2));color:var(--gold2);
  font-family:'Cinzel',serif;font-size:12px;font-weight:700;letter-spacing:1.5px;
  box-shadow:0 4px 14px rgba(13,92,69,0.3);display:none;transition:all .2s;}
.cont-btn.show{display:block;animation:popIn .4s cubic-bezier(.34,1.56,.64,1) both;}
.wa-hint{font-size:10px;color:#bbb;}

/* â”€â”€ S2 TIER â”€â”€ */
#s2{background:var(--bg);padding:12px;}
.s2-in{max-width:800px;margin:0 auto;height:100%;display:flex;flex-direction:column;gap:10px;}
.s2-hdr{text-align:center;}
.s2-ttl{font-family:'Cinzel',serif;font-size:15px;color:var(--jade);letter-spacing:2px;}
.s2-sub{font-size:11px;color:#666;margin-top:2px;}
.tier-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;flex:1;}
@media(max-width:700px){.tier-grid{grid-template-columns:1fr;overflow:auto;}}
.tc.group{border-color:rgba(88,44,180,0.35);background:linear-gradient(135deg,rgba(255,255,255,0.96),rgba(245,240,255,0.96));}
.tc-group-img{width:110px;height:110px;object-fit:cover;object-position:center;border-radius:50%;margin:0 auto 10px;display:block;border:3px solid rgba(88,44,180,0.3);}
.tc-call{background:linear-gradient(135deg,#5c2ca8,#7b4fc4);color:white;
  border:none;border-radius:9px;padding:10px;width:100%;cursor:pointer;
  font-family:'Cinzel',serif;font-size:10px;font-weight:700;letter-spacing:1px;
  box-shadow:0 3px 12px rgba(88,44,180,0.35);transition:all .2s;margin-top:auto;}
.tc-call:hover{transform:translateY(-2px);}
.wa-group-btn{background:#25d366;color:white;border:none;border-radius:9px;
  padding:8px;width:100%;cursor:pointer;font-family:'Heebo',sans-serif;
  font-size:11px;font-weight:700;margin-top:5px;transition:all .2s;}
.tc{background:var(--card);border-radius:14px;padding:16px;border:2px solid rgba(0,0,0,0.07);
  cursor:pointer;transition:all .2s;box-shadow:var(--shadow);display:flex;flex-direction:column;}
.tc:hover{transform:translateY(-3px);box-shadow:0 10px 26px rgba(0,0,0,0.1);}
.tc.feat{border-color:rgba(201,168,76,0.38);background:linear-gradient(135deg,rgba(255,255,255,0.96),rgba(253,248,218,0.96));}
.tc-fbadge{display:inline-block;background:linear-gradient(135deg,var(--gold),var(--gold2));
  color:var(--dark);font-size:9px;font-weight:800;letter-spacing:2px;
  padding:2px 11px;border-radius:50px;margin-bottom:6px;}
.tc-ic{font-size:26px;margin-bottom:5px;}
.tc-nm{font-family:'Cinzel',serif;font-size:14px;color:var(--jade);}
.tc-pr{font-family:'Abril Fatface',serif;font-size:30px;color:#1a2e1a;line-height:1.1;margin:3px 0;}
.tc-pr span{font-family:'Heebo',sans-serif;font-size:11px;color:#888;font-weight:400;}
.tc-feats{flex:1;font-size:11px;color:#444;line-height:2.1;margin:7px 0;}
.tc-feats div::before{content:'âœ“ ';color:var(--jade);font-weight:700;}
.tc-btn{width:100%;padding:10px;border-radius:9px;border:none;cursor:pointer;
  font-family:'Cinzel',serif;font-size:11px;font-weight:700;letter-spacing:1.5px;transition:all .2s;}
.tc-std{background:linear-gradient(135deg,var(--jade),var(--jade2));color:var(--gold2);box-shadow:0 3px 10px rgba(13,92,69,0.28);}
.tc-cus{background:rgba(201,168,76,0.1);color:var(--jade);border:1.5px solid rgba(13,92,69,0.2)!important;border:none;}

/* â”€â”€ S3 PIZZA â”€â”€ */
#s3{background:var(--bg);padding:11px;}
.s3-in{max-width:980px;margin:0 auto;height:100%;
  display:grid;grid-template-columns:280px 1fr;gap:12px;}
@media(max-width:700px){.s3-in{grid-template-columns:1fr;overflow:auto;}}
.pizza-steps{display:flex;flex-direction:column;gap:7px;}
.sc{background:var(--card);border-radius:11px;padding:11px 14px;
  border:1.5px solid rgba(0,0,0,0.07);}
.sh{display:flex;align-items:center;gap:7px;margin-bottom:7px;}
.sn{width:18px;height:18px;border-radius:50%;background:var(--jade);
  color:white;font-size:9px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.st{font-family:'Cinzel',serif;font-size:10px;color:var(--jade);}
.tok-row{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;}
.to{padding:8px 3px;border-radius:7px;border:2px solid rgba(0,0,0,0.07);
  text-align:center;cursor:pointer;transition:all .2s;background:white;}
.to:hover{border-color:rgba(13,92,69,0.3);}
.to.sel{border-color:var(--jade);background:rgba(13,92,69,0.07);}
.to .tn{font-size:11px;font-weight:800;color:#333;}
.to .tp{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--jade);font-weight:700;}
.to .ts{font-size:10px;color:#777;}
.add-row{display:flex;flex-direction:column;gap:5px;}
.at{display:flex;align-items:center;justify-content:space-between;
  padding:9px 12px;background:white;border-radius:8px;
  border:2px solid rgba(0,0,0,0.07);cursor:pointer;transition:all .2s;}
.at:hover{border-color:rgba(13,92,69,0.25);}
.at.on{border-color:var(--jade2);background:rgba(13,92,69,0.05);}
.at-l{display:flex;align-items:center;gap:7px;}
.at-ic{font-size:18px;}
.at-nm{font-size:12px;font-weight:700;color:#333;}
.at-pr{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--jade);font-weight:700;}
.sw{width:32px;height:17px;border-radius:9px;background:#ddd;position:relative;transition:background .2s;flex-shrink:0;}
.sw.on{background:var(--jade2);}
.sw::after{content:'';position:absolute;left:2px;top:2px;width:13px;height:13px;
  border-radius:50%;background:white;transition:transform .2s;box-shadow:0 1px 3px rgba(0,0,0,0.2);}
.sw.on::after{transform:translateX(15px);}

/* â”€â”€ VALUE TABLE (right side) â”€â”€ */
.val-col{display:flex;flex-direction:column;gap:0;overflow:hidden;}
.val-box{background:var(--card);border-radius:14px;padding:14px 16px;
  box-shadow:var(--shadow);border:2px solid rgba(13,92,69,0.1);
  display:flex;flex-direction:column;height:100%;}
.val-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
.val-title{font-family:'Cinzel',serif;font-size:12px;color:var(--jade);letter-spacing:1px;}
.val-plan-badge{font-family:'Cinzel',serif;font-size:11px;font-weight:700;
  background:rgba(13,92,69,0.1);color:var(--jade);border:1px solid rgba(13,92,69,0.2);
  border-radius:50px;padding:3px 12px;transition:all .3s;}

/* Table */
.val-table{width:100%;border-collapse:collapse;flex:1;}
.val-table thead tr{background:rgba(13,92,69,0.07);}
.val-table th{font-family:'Cinzel',serif;font-size:9px;letter-spacing:1.5px;
  color:var(--jade);padding:7px 8px;text-align:right;border-bottom:2px solid rgba(13,92,69,0.1);}
.val-table th:last-child{text-align:left;color:#b7770d;}
.val-row{border-bottom:1px solid rgba(0,0,0,0.05);transition:all .3s;}
.val-row.active{background:rgba(13,92,69,0.04);}
.val-row.inactive{opacity:0.35;}
.val-row td{padding:9px 8px;vertical-align:middle;}
.val-feat{display:flex;align-items:center;gap:7px;}
.val-icon{font-size:18px;flex-shrink:0;}
.val-fname{font-size:12px;font-weight:700;color:#1a2e1a;}
.val-fdesc{font-size:10px;color:#888;margin-top:1px;}
.val-num{font-family:'Abril Fatface',serif;font-size:20px;color:var(--jade);line-height:1;}
.val-unit{font-size:10px;color:#666;margin-top:1px;}
.val-num2{font-family:'Abril Fatface',serif;font-size:20px;color:#1a2e1a;line-height:1;}
.val-price-cell{text-align:left;}
.val-price{font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:700;color:var(--jade);}
.val-price.inactive{color:#aaa;}
.val-add-badge{font-size:9px;background:rgba(13,92,69,0.08);color:var(--jade);
  border:1px solid rgba(13,92,69,0.2);border-radius:50px;padding:2px 8px;white-space:nowrap;}
.val-add-badge.off{background:rgba(0,0,0,0.04);color:#aaa;border-color:rgba(0,0,0,0.1);}

/* Total row */
.val-total-row{background:linear-gradient(135deg,rgba(13,92,69,0.08),rgba(13,92,69,0.04));
  border-top:2px solid rgba(13,92,69,0.15)!important;}
.val-total-row td{padding:11px 8px;}
.val-patients-row{background:linear-gradient(135deg,rgba(201,168,76,0.07),rgba(201,168,76,0.03));
  border-top:1px solid rgba(201,168,76,0.2)!important;}
.val-patients-row td{padding:9px 8px;}
.calc-chip{display:inline-flex;align-items:center;gap:4px;
  background:rgba(13,92,69,0.09);border:1px solid rgba(13,92,69,0.2);
  border-radius:50px;padding:2px 10px;font-size:10px;color:var(--jade);font-weight:700;}
.val-total-label{font-family:'Cinzel',serif;font-size:11px;color:var(--jade);font-weight:700;}
.val-total-val{font-family:'Abril Fatface',serif;font-size:28px;color:var(--jade);}

/* CTA row */
.val-cta-row{display:flex;gap:8px;margin-top:12px;align-items:center;}
.val-cta{flex:1;padding:11px;border-radius:9px;border:none;cursor:pointer;
  background:linear-gradient(135deg,var(--jade),var(--jade2));color:var(--gold2);
  font-family:'Cinzel',serif;font-size:11px;font-weight:700;letter-spacing:1.5px;
  box-shadow:0 4px 12px rgba(13,92,69,0.3);transition:all .2s;}
.val-cta:hover{transform:translateY(-1px);}
.val-back{padding:11px 16px;border-radius:9px;border:1.5px solid rgba(0,0,0,0.1);
  background:transparent;cursor:pointer;font-size:11px;color:#777;font-family:'Heebo',sans-serif;}

/* Trans warning */
.trans-warn{font-size:11px;color:#7a3c00;background:rgba(231,76,60,0.06);
  border:1.5px solid rgba(231,76,60,0.25);border-radius:8px;
  padding:8px 12px;margin-top:6px;display:none;line-height:1.6;}
.trans-warn.show{display:block;animation:fadeUp .3s ease both;}
.warn-pulse{display:inline-block;animation:pulse 1.5s ease-in-out infinite;font-size:14px;margin-left:4px;}
@keyframes pulse{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.2);opacity:0.7}}

/* â”€â”€ S4 PAYMENT + LOGIN â”€â”€ */
#s4{background:var(--bg);padding:12px;}
.s4-in{max-width:800px;margin:0 auto;height:100%;display:flex;flex-direction:column;gap:10px;}
.s4-hdr{text-align:center;}
.s4-ttl{font-family:'Cinzel',serif;font-size:15px;color:var(--jade);letter-spacing:2px;}
.s4-sub{font-size:11px;color:#555;margin-top:2px;}
.s4-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;flex:1;}
@media(max-width:540px){.s4-grid{grid-template-columns:1fr;overflow:auto;}}

.pay-card{background:var(--card);border-radius:14px;padding:16px;
  box-shadow:var(--shadow);border:1.5px solid rgba(13,92,69,0.09);
  display:flex;flex-direction:column;gap:9px;}
.pay-ttl{font-family:'Cinzel',serif;font-size:12px;color:var(--jade);
  display:flex;align-items:center;gap:8px;}
.demo-badge{background:rgba(243,156,18,0.14);border:1px solid rgba(243,156,18,0.35);
  border-radius:50px;padding:2px 9px;font-size:9px;color:#b7770d;font-weight:700;letter-spacing:1px;}
.plan-box{background:rgba(13,92,69,0.06);border:1px solid rgba(13,92,69,0.13);
  border-radius:9px;padding:9px 12px;}
.plan-nm{font-family:'Cinzel',serif;font-size:11px;color:var(--jade);}
.plan-pr{font-family:'Abril Fatface',serif;font-size:24px;color:#1a2e1a;}
.plan-pr span{font-family:'Heebo',sans-serif;font-size:11px;color:#777;font-weight:400;}
.pinp{padding:8px 10px;border-radius:7px;font-size:13px;
  border:1.5px solid rgba(0,0,0,0.1);background:white;color:#1a2e1a;
  font-family:'Heebo',sans-serif;outline:none;direction:ltr;text-align:left;width:100%;}
.pinp:focus{border-color:var(--jade2);}
.p2{display:grid;grid-template-columns:1fr 1fr;gap:7px;}
.demo-note{font-size:10px;color:#b7770d;text-align:center;
  background:rgba(243,156,18,0.07);border-radius:6px;padding:5px;}
.pay-btn{width:100%;padding:11px;border-radius:9px;border:none;cursor:pointer;
  background:linear-gradient(135deg,#2d8a3e,#27ae60);color:white;
  font-family:'Cinzel',serif;font-size:11px;font-weight:700;letter-spacing:1.5px;
  box-shadow:0 4px 12px rgba(39,174,96,0.35);transition:all .2s;}
.pay-btn:hover{transform:translateY(-1px);}
.secure{display:flex;align-items:center;justify-content:center;gap:5px;font-size:10px;color:#999;}

.login-card{background:var(--card);border-radius:14px;padding:16px;
  box-shadow:var(--shadow);border:1.5px solid rgba(13,92,69,0.09);
  display:flex;flex-direction:column;gap:9px;}
.login-ttl{font-family:'Cinzel',serif;font-size:12px;color:var(--jade);}
.login-wel{background:linear-gradient(135deg,rgba(13,92,69,0.08),rgba(13,92,69,0.04));
  border-radius:9px;padding:11px;text-align:center;}
.login-av{font-size:32px;margin-bottom:3px;}
.login-nm{font-family:'Cinzel',serif;font-size:13px;color:var(--jade);}
.login-pl{font-size:10px;color:#777;margin-top:1px;}
.trial-box{background:linear-gradient(135deg,rgba(201,168,76,0.1),rgba(201,168,76,0.05));
  border:1px solid rgba(201,168,76,0.28);border-radius:8px;
  padding:7px 11px;font-size:11px;color:#7a5520;text-align:center;}
.linp{padding:8px 10px;border-radius:7px;font-size:13px;
  border:1.5px solid rgba(0,0,0,0.1);background:white;color:#1a2e1a;
  font-family:'Heebo',sans-serif;outline:none;direction:ltr;text-align:left;width:100%;}
.linp:focus{border-color:var(--jade2);}
.linp.valid{border-color:#27ae60!important;background:rgba(39,174,96,0.07)!important;}
.linp.error{border-color:var(--red)!important;background:rgba(231,76,60,0.05)!important;}
.pw-strength{font-size:10px;margin-top:2px;display:none;}
.pw-strength.show{display:flex;align-items:center;gap:5px;}
.pw-ok{color:#27ae60;} .pw-err{color:var(--red);}
.login-note{font-size:10px;color:#999;text-align:center;
  background:rgba(13,92,69,0.04);border-radius:6px;padding:5px;}
.login-btn{width:100%;padding:11px;border-radius:9px;border:none;cursor:pointer;
  background:linear-gradient(135deg,var(--jade),var(--jade2));color:var(--gold2);
  font-family:'Cinzel',serif;font-size:11px;font-weight:700;letter-spacing:1.5px;
  box-shadow:0 4px 12px rgba(13,92,69,0.3);transition:all .2s;}
.login-btn:hover{transform:translateY(-1px);}

.back-btn{background:transparent;border:1.5px solid rgba(0,0,0,0.1);
  border-radius:7px;padding:6px 14px;cursor:pointer;
  font-size:11px;color:#777;font-family:'Heebo',sans-serif;transition:all .2s;}
.back-btn:hover{border-color:rgba(0,0,0,0.22);color:#333;}

@keyframes popIn{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
</style>
</head>
<body>

<!-- NAVBAR -->
<div class="nav">
  <div class="nav-brand">â˜¯ MERIDIAN</div>
  <div class="nav-r">
    <div class="nav-step" id="navStep">×›× ×™×¡×” ×¨××©×•× ×”</div>
    <div class="nav-clock" id="navClock">00:00:00</div>
  </div>
</div>

<!-- â•â• S0: TEASER â•â• -->
<div id="s0" class="screen active">
  <div class="s0-body">
    <div class="s0-eye">â˜¯ MERIDIAN â€” Clinical Intelligence TCM</div>
    <div class="s0-ttl">×”×¢×•×–×¨ ×”×§×œ×™× ×™<br>×©××—×›×” ×œ×š</div>
    <div class="s0-sub">×™×•×ª×¨ ×-1,000 ×©××œ×•×ª TCM Â· AI ×§×œ×™× ×™ ×‘×¢×‘×¨×™×ª<br>×”×§×œ×˜×” ×•×ª××œ×•×œ ××•×˜×•××˜×™ Â· × ×™×”×•×œ ××˜×•×¤×œ×™× ×—×›×</div>
    <div class="s0-badges">
      <div class="s0-badge">â˜¯ 1,000+ ×©××œ×•×ª</div>
      <div class="s0-badge">ğŸ™ï¸ ×ª××œ×•×œ ×¢×‘×¨×™×ª</div>
      <div class="s0-badge">ğŸ“± ×× ×™×™×“ ×•×“×¡×§×˜×•×¤</div>
      <div class="s0-badge">ğŸ”’ ×××•×‘×˜×—</div>
    </div>
    <button class="s0-btn" onclick="go('s1')">ğŸš€ ×”×¦×˜×¨×£ ×œ-MERIDIAN</button>
  </div>
</div>

<!-- â•â• S1: REGISTER + WA â•â• -->
<div id="s1" class="screen">
  <div class="s1-grid">

    <!-- Form -->
    <div class="card">
      <div class="c-ttl">ğŸ“‹ ×¤×¨×˜×™ ×”×¨×©××”</div>
      <div class="c-sub">××œ× ×•×©×œ×— WhatsApp â€” ×•××– ×”××©×š ×œ×‘×—×™×¨×ª ×ª×•×›× ×™×ª</div>
      <div class="fg2">
        <div class="field">
          <label class="flbl">×©× ×¤×¨×˜×™ *</label>
          <input class="finp" id="f_first" placeholder="×™×©×¨××œ" oninput="upWA()">
          <div class="ferr" id="e_first">×©×“×” ×—×•×‘×”</div>
        </div>
        <div class="field">
          <label class="flbl">×©× ××©×¤×—×” *</label>
          <input class="finp" id="f_last" placeholder="×›×”×Ÿ" oninput="upWA()">
          <div class="ferr" id="e_last">×©×“×” ×—×•×‘×”</div>
        </div>
        <div class="field full">
          <label class="flbl">×›×•×ª×¨×ª ××§×¦×•×¢×™×ª *</label>
          <select class="fsel" id="f_title" onchange="upWA()">
            <option value="">×‘×—×¨...</option>
            <option>××˜×¤×œ/×ª ×‘×¨×¤×•××” ×¡×™× ×™×ª</option>
            <option>×“×™×§×•×¨ ×¡×™× ×™ ××•×¡××š</option>
            <option>× ×˜×•×¨×•×¤×ª</option>
            <option>×¨×•×¤×/×” ×•×¨×¤×•××” ××©×œ×™××”</option>
            <option>××˜×¤×œ/×ª ×”×•×œ×™×¡×˜×™</option>
            <option>××—×¨</option>
          </select>
          <div class="ferr" id="e_title">×©×“×” ×—×•×‘×”</div>
        </div>
        <div class="field full">
          <label class="flbl">×©× ×”×§×œ×™× ×™×§×”</label>
          <input class="finp" id="f_clinic" placeholder="×§×œ×™× ×™×§×ª ×©×œ×•×..." oninput="upWA()">
        </div>
        <div class="field">
          <label class="flbl">××™××™×™×œ *</label>
          <input class="finp" id="f_email" type="email" placeholder="you@clinic.com" dir="ltr" oninput="upWA()">
          <div class="ferr" id="e_email">××™××™×™×œ ×œ× ×ª×§×™×Ÿ</div>
        </div>
        <div class="field">
          <label class="flbl">WhatsApp *</label>
          <input class="finp" id="f_wa" type="tel" placeholder="05X-XXXXXXX" dir="ltr" oninput="upWA()">
          <div class="ferr" id="e_wa">×©×“×” ×—×•×‘×”</div>
        </div>
        <div class="field">
          <label class="flbl">×¢×™×¨</label>
          <input class="finp" id="f_city" placeholder="×ª×œ ××‘×™×‘" oninput="upWA()">
        </div>
        <div class="field">
          <label class="flbl">××˜×¤×œ×™× ×‘×§×œ×™× ×™×§×”</label>
          <select class="fsel" id="f_size" onchange="upWA()">
            <option value="1">××˜×¤×œ ×™×—×™×“</option>
            <option value="2-3">2-3</option>
            <option value="4-10">4-10</option>
            <option value="10+">10+</option>
          </select>
        </div>
      </div>
      <button class="back-btn" onclick="go('s0')" style="align-self:flex-start;margin-top:auto;">â† ×—×–×•×¨</button>
    </div>

    <!-- WA Card -->
    <div class="wa-card">
      <div class="wa-icon">ğŸ’¬</div>
      <div class="wa-ttl">×©×œ×— ×œ×™ WhatsApp â† ×§×‘×œ ××™×©×•×¨</div>
      <div class="wa-desc">××œ× ×”×˜×•×¤×¡ â†’ ×”×¦×’ ×ª×¦×•×’×” ××§×“×™××” â†’ ×©×œ×— WhatsApp ×œ××‘×©×™ â†’ ×›×¤×ª×•×¨ "×”××©×š" ×™×¤×ª×—</div>
      <div class="wa-prev" id="waPreview">××œ× ××ª ×”×˜×•×¤×¡ ××©×××œ...</div>
      <button class="wa-btn" id="waSendBtn" onclick="sendWA()" disabled>
        ğŸ’¬ ×©×œ×— WhatsApp ×œ××™×©×•×¨
      </button>
      <button class="cont-btn" id="contBtn" onclick="go('s2')">
        ×”××©×š ×œ×‘×—×™×¨×ª ×ª×•×›× ×™×ª â†
      </button>
      <div class="wa-hint">×›×¤×ª×•×¨ "×”××©×š" ×™×¤×ª×— ×œ××—×¨ ×©×œ×™×—×ª WhatsApp</div>
    </div>

  </div>
</div>

<!-- â•â• S2: TIER â•â• -->
<div id="s2" class="screen">
  <div class="s2-in">
    <div class="s2-hdr">
      <div class="s2-ttl" id="s2ttl">×‘×—×¨ ×ª×•×›× ×™×ª MERIDIAN</div>
      <div class="s2-sub">××—×™×¨ ×§×‘×•×¢ ××• ×‘× ×” ×ª×•×›× ×™×ª ××•×ª×××ª ××™×©×™×ª</div>
    </div>
    <div class="tier-grid">
      <div class="tc">
        <div class="tc-ic">ğŸŒ¿</div>
        <div class="tc-nm">MERIDIAN Standard</div>
        <div class="tc-pr">$18.90<span>/×—×•×“×©</span></div>
        <div class="tc-feats">
          <div>AI ×§×œ×™× ×™ ×‘×¢×‘×¨×™×ª</div>
          <div>5 ××¤×’×©×™× ×‘×™×•×</div>
          <div>1,000+ ×©××œ×•×ª TCM</div>
          <div>14 ×™×•× × ×™×¡×™×•×Ÿ ×—×™× ×</div>
          <div>×‘×™×˜×•×œ ×‘×›×œ ×¢×ª</div>
        </div>
        <button class="tc-btn tc-std" onclick="pickTier('standard')">×”×¦×˜×¨×£ ×œ-Standard â†</button>
      </div>
      <div class="tc feat">
        <div class="tc-fbadge">â­ ×”×›×™ ×’××™×©</div>
        <div class="tc-ic">ğŸ¯</div>
        <div class="tc-nm">MERIDIAN Custom</div>
        <div class="tc-pr" style="font-size:18px;font-family:'Cinzel',serif;color:var(--jade);">×‘× ×” ×ª×•×›× ×™×ª<br>××™×©×™×ª</div>
        <div class="tc-feats">
          <div>×‘×—×¨ 5 / 15 / âˆ ××¤×’×©×™×/×™×•×</div>
          <div>×”×§×œ×˜×ª ××•×“×™×• ××•×¤×¦×™×•× ×œ×™×ª</div>
          <div>×ª××œ×•×œ ×¢×‘×¨×™×ª AI</div>
          <div>××—×™×¨ ××•×ª×× ×œ×¦×¨×›×™×</div>
          <div>14 ×™×•× × ×™×¡×™×•×Ÿ ×—×™× ×</div>
        </div>
        <button class="tc-btn tc-cus" onclick="pickTier('custom')">×‘× ×” ×ª×•×›× ×™×ª ××•×ª×××ª â†</button>
      </div>
    </div>
      <!-- GROUP CARD -->
      <div class="tc group">
        <img src="https://iqfglrwjemogoycbzltt.supabase.co/storage/v1/object/public/images/group.jpg" class="tc-group-img" alt="Group Plan">
        <div class="tc-nm" style="color:#5c2ca8;">MERIDIAN ×§×œ×™× ×™×§×”</div>
        <div class="tc-pr" style="font-size:16px;font-family:'Cinzel',serif;color:#5c2ca8;">×ª×•×›× ×™×ª<br>×§×‘×•×¦×ª×™×ª</div>
        <div class="tc-feats" style="font-size:11px;">
          <div>2-10 ××˜×¤×œ×™× ×‘××•×ª×” ×§×œ×™× ×™×§×”</div>
          <div>××—×™×¨ ×œ×¤×™ ××¡×¤×¨ ××˜×¤×œ×™×</div>
          <div>× ×™×”×•×œ ××¨×›×–×™ â€” ×—×©×‘×•×Ÿ ××—×“</div>
          <div>×›×œ ×ª×•×¡×¤×•×ª Custom ×›×œ×•×œ×•×ª</div>
          <div>×›××• Netflix â€” ×©×ª×¤×• ×—×›×</div>
        </div>
        <button class="tc-call" onclick="callGroup()">ğŸ“ ×”×ª×§×©×œ ×œ×§×‘×œ ×”×¦×¢×” ××™×•×—×“×ª</button>
        <button class="wa-group-btn" onclick="waGroup()">ğŸ’¬ WhatsApp ×œ×¤×¨×˜×™×</button>
      </div>
    </div>
    <div style="text-align:center;">
      <button class="back-btn" onclick="go('s1')">â† ×—×–×•×¨</button>
    </div>
  </div>
</div>

<!-- â•â• S3: PIZZA â•â• -->
<div id="s3" class="screen">
  <div class="s3-in">

    <!-- LEFT: Pizza Steps -->
    <div class="pizza-steps">
      <!-- Step 1: Base -->
      <div class="sc">
        <div class="sh"><div class="sn">1</div><div class="st">×‘×¡×™×¡ MERIDIAN â€” ×ª××™×“ ×›×œ×•×œ</div></div>
        <div style="font-size:11px;color:#555;background:rgba(13,92,69,0.06);border-radius:6px;padding:8px 10px;">
          âœ… AI ×§×œ×™× ×™ Â· 1,000+ ×©××œ×•×ª TCM Â· × ×™×”×•×œ ××˜×•×¤×œ×™×<br>
          <strong style="color:var(--jade);">$18.90/×—×•×“×©</strong>
        </div>
      </div>

      <!-- Step 2: Tier -->
      <div class="sc">
        <div class="sh"><div class="sn">2</div><div class="st">×‘×—×¨ tier â€” ×›××” ××¤×’×©×™× ×‘×™×•×?</div></div>
        <div class="tok-row">
          <div class="to sel" id="to_s" onclick="selTok('s')">
            <div class="tn">Starter</div>
            <div class="tp">+$9</div>
            <div class="ts">5 ××¤×’×©/×™×•×</div>
          </div>
          <div class="to" id="to_p" onclick="selTok('p')">
            <div class="tn">Pro</div>
            <div class="tp">+$25</div>
            <div class="ts">15 ××¤×’×©/×™×•×</div>
          </div>
          <div class="to" id="to_u" onclick="selTok('u')">
            <div class="tn">Unlimited</div>
            <div class="tp">+$42</div>
            <div class="ts">âˆ ××¤×’×©/×™×•×</div>
          </div>
        </div>
      </div>

      <!-- Step 3: Add-ons -->
      <div class="sc">
        <div class="sh"><div class="sn">3</div><div class="st">×ª×•×¡×¤×•×ª (××•×¤×¦×™×•× ×œ×™)</div></div>
        <div class="add-row">
          <div class="at" id="at_audio" onclick="togAdd('audio')">
            <div class="at-l">
              <span class="at-ic">ğŸ™ï¸</span>
              <div><div class="at-nm">×”×§×œ×˜×ª ××•×“×™×•</div>
              <div style="font-size:9px;color:#888;">MP3 Â· Supabase Storage</div></div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <span class="at-pr">+$8</span>
              <div class="sw" id="sw_audio"></div>
            </div>
          </div>
          <div class="at" id="at_trans" onclick="togAdd('trans')">
            <div class="at-l">
              <span class="at-ic">ğŸ“</span>
              <div>
                <div class="at-nm">×ª××œ×•×œ ×¢×‘×¨×™×ª AI
                  <span class="info-tip" onclick="event.stopPropagation();document.getElementById('tipTrans').classList.toggle('show')">â„¹ï¸
                    <div class="tip-box" id="tipTrans">
                      <strong>×œ××” Scribe ×©×•×•×” ××ª ×–×”?</strong><br>
                      âœ“ ×›×œ ××¤×’×© × ×©××¨ ×›×“×•×— ×‘×ª×™×§ ×”××˜×•×¤×œ<br>
                      âœ“ ×”××˜×¤×œ ××ª×—×™×œ ×¤×’×™×©×” ×”×‘××” ×¢× ×™×“×¢ ××œ×<br>
                      âœ“ ×—×•×¡×š ~10 ×“×§×•×ª/××¤×’×© ×œ×¡×™×›×•× ×™×“× ×™<br>
                      âœ“ ×”×©×§×¢×” ×—×›××” ×‘×˜×™×¤×•×œ ××§×¦×•×¢×™ ×•×¨×¦×™×£
                    </div>
                  </span>
                </div>
                <div style="font-size:9px;color:#888;">OpenAI Whisper Â· ×›×œ ×”-tiers</div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <span class="at-pr" id="trans_price_badge">+$21</span>
              <div class="sw" id="sw_trans"></div>
            </div>
          </div>
          <div class="trans-warn" id="transWarn">
            <span class="warn-pulse">ğŸ’¡</span> <strong id="transWarnTitle">×©×™× ×œ×‘ â€” ×ª××œ×•×œ ××¡×•×‘×¡×“</strong><br>
            <span id="transWarnBody">×ª××—×•×¨ ×ª××œ×•×œ ××—×•×©×‘ ×œ×¤×™ ×ª×•×›× ×™×ª â€” ×¨××” ×¤×™×¨×•×˜ ×‘×˜×‘×œ×ª ×”×¢×¨×š.</span>
          </div>
        </div>
      </div>

      <button class="back-btn" onclick="go('s2')" style="align-self:flex-start;">â† ×—×–×•×¨ ×œ×ª×•×›× ×™×•×ª</button>
    </div>

    <!-- RIGHT: Live Value Table -->
    <div class="val-col">
      <div class="val-box">
        <div class="val-header">
          <div class="val-title">â˜¯ ××” ××ª×” ××§×‘×œ ×‘×“×™×•×§</div>
          <div class="val-plan-badge" id="valBadge">MERIDIAN Starter</div>
        </div>

        <table class="val-table">
          <thead>
            <tr>
              <th>×¤×™×¦'×¨</th>
              <th>×œ××¤×’×©</th>
              <th>×œ×—×•×“×©</th>
              <th>××—×™×¨</th>
            </tr>
          </thead>
          <tbody>
            <!-- Row 1: Core â€” always active -->
            <tr class="val-row active" id="vr_core">
              <td>
                <div class="val-feat">
                  <span class="val-icon">ğŸ«“</span>
                  <div><div class="val-fname">Core MERIDIAN</div>
                  <div class="val-fdesc">AI + ×©××œ×•×ª TCM + × ×™×”×•×œ</div></div>
                </div>
              </td>
              <td>
                <div class="val-num" id="vc_sess">110</div>
                <div class="val-unit">××¤×’×©×™×/×—×•×“×©</div>
              </td>
              <td>
                <div class="val-num2" id="vc_days">22 ×™××™×</div>
                <div class="val-unit" id="vc_perday">Ã— 5/×™×•×</div>
              </td>
              <td class="val-price-cell">
                <div class="val-price">$18.90</div>
                <div class="val-unit">×§×‘×•×¢</div>
              </td>
            </tr>

            <!-- Row 2: Tokens -->
            <tr class="val-row active" id="vr_tok">
              <td>
                <div class="val-feat">
                  <span class="val-icon">ğŸ…</span>
                  <div><div class="val-fname" id="vt_tier">Starter Tokens</div>
                  <div class="val-fdesc">Claude AI queries</div></div>
                </div>
              </td>
              <td>
                <div class="val-num">16K</div>
                <div class="val-unit">×˜×•×§× ×™×/××¤×’×©</div>
              </td>
              <td>
                <div class="val-num2" id="vt_monthly">1.76M</div>
                <div class="val-unit" id="vt_sessmo">110 ×©××™×œ×ª×•×ª</div>
              </td>
              <td class="val-price-cell">
                <div class="val-price" id="vt_price">+$9</div>
                <div class="val-unit" id="vt_badge"><span class="val-add-badge">5 ××¤×’×©/×™×•×</span></div>
              </td>
            </tr>

            <!-- Row 3: Audio -->
            <tr class="val-row inactive" id="vr_audio">
              <td>
                <div class="val-feat">
                  <span class="val-icon">ğŸ™ï¸</span>
                  <div><div class="val-fname">×”×§×œ×˜×ª ××•×“×™×•</div>
                  <div class="val-fdesc">MP3 Â· Supabase Storage</div></div>
                </div>
              </td>
              <td>
                <div class="val-num">50</div>
                <div class="val-unit">×“×§×•×ª ×”×§×œ×˜×”</div>
              </td>
              <td>
                <div class="val-num2" id="va_monthly">2.5GB</div>
                <div class="val-unit" id="va_files">110 ×§×‘×¦×™×</div>
              </td>
              <td class="val-price-cell">
                <div class="val-price inactive" id="va_price">+$8</div>
                <div class="val-unit"><span class="val-add-badge off" id="va_badge">×œ× ×¤×¢×™×œ</span></div>
              </td>
            </tr>

            <!-- Row 4: Transcription -->
            <tr class="val-row inactive" id="vr_trans">
              <td>
                <div class="val-feat">
                  <span class="val-icon">ğŸ“</span>
                  <div><div class="val-fname">×ª××œ×•×œ ×¢×‘×¨×™×ª AI</div>
                  <div class="val-fdesc">Whisper Â· 85-90% ×“×™×•×§</div></div>
                </div>
              </td>
              <td>
                <div class="val-num">50</div>
                <div class="val-unit">×“×§×•×ª ×ª××œ×•×œ</div>
              </td>
              <td>
                <div class="val-num2" id="vtr_monthly">5,500</div>
                <div class="val-unit" id="vtr_mins">×“×§×•×ª/×—×•×“×©</div>
              </td>
              <td class="val-price-cell">
                <div class="val-price inactive" id="vtr_price">+$28</div>
                <div class="val-unit"><span class="val-add-badge off" id="vtr_badge">×œ× ×¤×¢×™×œ</span></div>
              </td>
            </tr>

            <!-- Total row -->
            <tr class="val-row val-total-row">
              <td colspan="2">
                <div class="val-total-label">â˜¯ ×¡×”"×› ×œ×—×•×“×©</div>
                <div style="font-size:10px;color:#888;margin-top:2px;" id="totalDesc">110 ××¤×’×©×™× Â· Starter</div>
              </td>
              <td colspan="2" style="text-align:left;">
                <div class="val-total-val" id="valTotal">$27.90</div>
                <div style="font-size:10px;color:#888;">14 ×™×•× × ×™×¡×™×•×Ÿ ×—×™× ×</div>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="val-cta-row">
          <button class="val-cta" onclick="confirmPlan()">âœ… ×× ×™ ×¨×•×¦×” ×–×” â€” ×”××©×š ×œ×ª×©×œ×•× â†</button>
          <button class="val-back" onclick="go('s2')">â† ×—×–×•×¨</button>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- â•â• S4: PAYMENT + LOGIN â•â• -->
<div id="s4" class="screen">
  <div class="s4-in">
    <div class="s4-hdr">
      <div class="s4-ttl" id="s4ttl">ğŸ‰ ×›××¢×˜ ×¡×™×™×× ×•!</div>
      <div class="s4-sub" id="s4sub">×”×©×œ× ×ª×©×œ×•× ×•×¦×•×¨ ×—×©×‘×•×Ÿ â€” ×’×™×©×” ××™×™×“×™×ª ×œ-MERIDIAN</div>
    </div>
    <div class="s4-grid">

      <!-- Payment -->
      <div class="pay-card">
        <div class="pay-ttl">ğŸ’³ ×ª×©×œ×•× <span class="demo-badge">âš¡ DEMO</span></div>
        <div class="plan-box">
          <div class="plan-nm" id="payNm">MERIDIAN Starter</div>
          <div class="plan-pr" id="payPr">$27.90<span>/×—×•×“×©</span></div>
        </div>
        <input class="pinp" placeholder="×©× ×‘×¢×œ ×”×›×¨×˜×™×¡">
        <input class="pinp" placeholder="1234  5678  9012  3456" maxlength="19"
          oninput="this.value=this.value.replace(/\D/g,'').replace(/(.{4})/g,'$1 ').trim()">
        <div class="p2">
          <input class="pinp" placeholder="MM/YY" maxlength="5">
          <input class="pinp" placeholder="CVV" maxlength="3">
        </div>
        <div class="demo-note">âš¡ DEMO â€” ×—×™×‘×•×¨ Stripe ×××™×ª×™ ×‘×©×œ×‘ P3</div>
        <button class="pay-btn" onclick="demoPayment()">ğŸ”’ ×©×œ× ×•×§×‘×œ ×’×™×©×” â†</button>
        <div class="secure">ğŸ”’ SSL Â· Stripe Â· PCI DSS</div>
      </div>

      <!-- Login -->
      <div class="login-card">
        <div class="login-ttl">â˜¯ ×¦×•×¨ ×—×©×‘×•×Ÿ â€” ×›× ×¡ ×œ-MERIDIAN CRM</div>
        <div class="login-wel">
          <div class="login-av">ğŸ‘¨â€âš•ï¸</div>
          <div class="login-nm" id="loginNm">×‘×¨×•×š ×”×‘×!</div>
          <div class="login-pl" id="loginPl">MERIDIAN Â· $27.90/×—×•×“×©</div>
        </div>
        <div class="trial-box">ğŸ <strong>14 ×™×•× × ×™×¡×™×•×Ÿ ×—×™× ×</strong> â€” ×œ×œ× ×—×™×•×‘ ×¢×“ ×œ××—×¨ ×”× ×™×¡×™×•×Ÿ</div>
        <input class="linp" id="loginEmail" placeholder="your@email.com" type="email">
        <input class="linp" id="loginPass" placeholder="×¡×™×¡××” (8+ ×ª×•×•×™×)" type="password" oninput="checkPass()">
        <div class="pw-strength" id="pwStrength"></div>
        <input class="linp" id="loginPass2" placeholder="×××ª ×¡×™×¡××”" type="password" oninput="checkPass()">
        <div class="pw-strength" id="pwMatch"></div>
        <div class="login-note">×œ××—×¨ ×ª×©×œ×•× â€” ×¤×¨×˜×™× ××œ×• ×™×©××©×• ×œ×›× ×™×¡×” ×œ-CRM</div>
        <button class="login-btn" onclick="demoLogin()">â˜¯ ×¦×•×¨ ×—×©×‘×•×Ÿ ×•×›× ×¡ â†</button>
      </div>

    </div>
    <div style="text-align:center;">
      <button class="back-btn" onclick="go('s3')">â† ×—×–×•×¨ ×œ×ª×•×›× ×™×ª</button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€ SUPABASE â”€â”€â”€
const SUPA_URL='https://iqfglrwjemogoycbzltt.supabase.co';
const SUPA_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlxZmdscndqZW1vZ295Y2J6bHR0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1NTM4ODMsImV4cCI6MjA4NDEyOTg4M30.DTREv3efs86_HzESyWm-7480ImfEVgC6T-xBdS6A2F8';
let supa=null;
try{
  if(SUPA_KEY!=='YOUR_SUPABASE_ANON_KEY')
    supa=window.supabase.createClient(SUPA_URL,SUPA_KEY);
}catch(e){}

// â”€â”€â”€ STATE â”€â”€â”€
let reg={};
let pizza={tok:'s',audio:false,trans:false};
const WA='972505231042'; // â† ×”×—×œ×£ ×‘××¡×¤×¨ ×©×œ×š

// â”€â”€â”€ TIER DATA â€” all volumes pre-calculated â”€â”€â”€
// 22 working days/month Â· 8 queries/session Â· 2000 tokens/query = 16K tokens/session
// audio: 50min Ã— 23MB = ~23MB/session (64kbps mono MP3)
// transcription: 50 min/session
const TIERS = {
  s:{ name:'Starter', price:9,  daily:5,  monthly:110,
      tokPerSess:'16,000', tokMonthly:'1.76M',
      audioMB:'23MB',  audioGB:'2.5GB',  audioFiles:110,
      transMin:50, transMonthly:'5,500', badge:'5 ××¤×’×©/×™×•×', transPrice:21.45 },
  p:{ name:'Pro',     price:25, daily:15, monthly:330,
      tokPerSess:'16,000', tokMonthly:'5.28M',
      audioMB:'23MB',  audioGB:'7.6GB',  audioFiles:330,
      transMin:50, transMonthly:'16,500',badge:'15 ××¤×’×©/×™×•×', transPrice:64.35 },
  u:{ name:'Unlimited',price:42,daily:25, monthly:550,
      tokPerSess:'16,000', tokMonthly:'8.8M',
      audioMB:'23MB',  audioGB:'12.7GB', audioFiles:550,
      transMin:50, transMonthly:'27,500',badge:'âˆ ××¤×’×©/×™×•×', transPrice:107.25 },
};
const PLAN_NAMES={
  's00':'MERIDIAN Starter',    's10':'Starter + Audio',
  's01':'Starter + Scribe',    's11':'Starter Complete',
  'p00':'MERIDIAN Pro',        'p10':'Pro + Audio',
  'p01':'Pro + Scribe',        'p11':'Pro Complete',
  'u00':'MERIDIAN Unlimited',  'u10':'Unlimited + Audio',
  'u01':'Unlimited + Scribe',  'u11':'MERIDIAN Ultimate â­',
};

// â”€â”€â”€ CLOCK â”€â”€â”€
const pad=x=>String(x).padStart(2,'0');
function tickClock(){
  const n=new Date();
  document.getElementById('navClock').textContent=
    `${pad(n.getHours())}:${pad(n.getMinutes())}:${pad(n.getSeconds())}`;
}
setInterval(tickClock,1000); tickClock();

// â”€â”€â”€ NAV â”€â”€â”€
const LABELS={s0:'×›× ×™×¡×” ×¨××©×•× ×”',s1:'×”×¨×©××”',s2:'×‘×—×™×¨×ª ×ª×•×›× ×™×ª',s3:'×‘× ×” ×ª×•×›× ×™×ª',s4:'×ª×©×œ×•× ×•×’×™×©×”'};
function go(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.getElementById('navStep').textContent=LABELS[id]||'';
}

// â”€â”€â”€ WA PREVIEW â”€â”€â”€
function upWA(){
  const v=id=>document.getElementById(id).value.trim();
  const first=v('f_first'),last=v('f_last'),title=v('f_title'),
        clinic=v('f_clinic'),email=v('f_email'),wa=v('f_wa'),
        city=v('f_city'),size=document.getElementById('f_size').value;
  const ok=first&&last&&title&&email&&wa;
  document.getElementById('waPreview').textContent = ok
    ? `×©×œ×•× ××‘×©×™! ğŸ‘‹\n×× ×™ ${first} ${last}\n${title}${clinic?' | '+clinic:''}\n\nğŸ“ ${city||'â€”'} | ${size} ××˜×¤×œ×™×\nğŸ“§ ${email}\nğŸ“± ${wa}\n\n××¢×•× ×™×™×Ÿ/×ª ×œ×”×¦×˜×¨×£ ×œ-MERIDIAN ğŸ™`
    : '××œ× ××ª ×”×˜×•×¤×¡ ××©×××œ...';
  document.getElementById('waSendBtn').disabled=!ok;
  if(ok) reg={first,last,title,clinic,email,wa,city,size,
    token:'MRD-'+Math.random().toString(36).substr(2,8).toUpperCase(),
    ts:new Date().toISOString()};
}

// â”€â”€â”€ SEND WA â”€â”€â”€
function sendWA(){
  const v=id=>document.getElementById(id).value.trim();
  let ok=true;
  const chk=(val,eid)=>{const bad=!val;document.getElementById(eid).classList.toggle('show',bad);if(bad)ok=false;};
  chk(v('f_first'),'e_first'); chk(v('f_last'),'e_last'); chk(v('f_title'),'e_title');
  chk(v('f_email')&&v('f_email').includes('@'),'e_email'); chk(v('f_wa'),'e_wa');
  if(!ok) return;
  if(supa){
    supa.from('meridian_leads').insert([{
      first_name:reg.first,last_name:reg.last,professional_title:reg.title,
      clinic_name:reg.clinic,email:reg.email,whatsapp:reg.wa,
      city:reg.city,clinic_size:reg.size,token:reg.token,
      status:'registered',created_at:reg.ts
    }]).then(()=>{}).catch(()=>{});
  }
  try{const l=JSON.parse(localStorage.getItem('meridian_leads')||'[]');
    l.push(reg);localStorage.setItem('meridian_leads',JSON.stringify(l));}catch(e){}
  window.open(`https://wa.me/${WA}?text=${encodeURIComponent(document.getElementById('waPreview').textContent)}`,'_blank');
  setTimeout(()=>{
    document.getElementById('contBtn').classList.add('show');
    const b=document.getElementById('waSendBtn');
    b.textContent='âœ… × ×©×œ×—!'; b.style.background='#aaa'; b.disabled=true;
  },700);
}

// â”€â”€â”€ TIER PICKER â”€â”€â”€
function pickTier(t){
  document.getElementById('s2ttl').textContent=
    `×©×œ×•× ${reg.first||''}! ${t==='standard'?'××¦×•×™×Ÿ â€” Standard':'××¢×•×œ×” â€” ×‘× ×” ×ª×•×›× ×™×ª'}`;
  go('s3');
  selTok('s');
}

// â”€â”€â”€ PIZZA + VALUE TABLE â”€â”€â”€
function selTok(t){
  pizza.tok=t;
  ['s','p','u'].forEach(x=>document.getElementById('to_'+x).classList.toggle('sel',x===t));
  upTable();
}

function togAdd(type){
  pizza[type]=!pizza[type];
  document.getElementById('at_'+type).classList.toggle('on',pizza[type]);
  document.getElementById('sw_'+type).classList.toggle('on',pizza[type]);
  // Smart warning: transcription subsidy is real math
  const warn=document.getElementById('transWarn');
  if(pizza.trans){
    const T=TIERS[pizza.tok];
    const realCost=(T.monthly*50*0.003).toFixed(2);
    const profit=(T.transPrice-parseFloat(realCost)).toFixed(2);
    const wt=document.getElementById('transWarnTitle');
    const wb=document.getElementById('transWarnBody');
    if(parseFloat(profit)<0){
      wt.textContent='ğŸ’° ×ª××œ×•×œ ××¡×•×‘×¡×“ â€” ××—×™×¨ ×”×§××” ××•×’×‘×œ';
      wb.innerHTML=`×‘-<strong>${T.name}</strong> (${T.monthly} ××¤×’×©×™×/×—×•×“×©), ×ª××œ×•×œ ${T.transMonthly} ×“×§×•×ª ×¢×•×œ×” ×‘×¤×•×¢×œ <strong>$${realCost}</strong>.<br>
      ××ª×” ××©×œ× <strong>$${T.transPrice}</strong> ×‘×œ×‘×“ â€” ×”×¤×¨×© <strong>$${Math.abs(profit)}</strong> ××¡×•×‘×¡×“ ×¢"×™ MERIDIAN ×œ×ª×§×•×¤×ª ×”×”×§××”.<br>
      <span style="color:#27ae60;font-weight:700;">×œ××—×¨ 3 ×—×•×“×©×™× â€” ×ª××—×•×¨ ××™×©×™ ×œ×¤×™ ×¦×¨×™×›×” ×‘×¤×•×¢×œ.</span>`;
      warn.classList.add('show');
    } else {
      wt.textContent='âœ… ××—×™×¨ ×ª××œ×•×œ ×›×“××™';
      wb.innerHTML=`×‘-<strong>${T.name}</strong> â€” ×¢×œ×•×ª ×××™×ª×™×ª <strong>$${realCost}</strong>, ××ª×” ××©×œ× <strong>$${T.transPrice}</strong>. ×¨×•×•×—×™ ×œ×©× ×™ ×”×¦×“×“×™×.`;
      warn.classList.add('show');
    }
  } else {
    document.getElementById('transWarn').classList.remove('show');
  }
  upTable();
}

function set(id,val){ const el=document.getElementById(id); if(el) el.textContent=val; }
function setHTML(id,val){ const el=document.getElementById(id); if(el) el.innerHTML=val; }

function upTable(){
  const T=TIERS[pizza.tok];
  const base=18.90, tok=T.price, audio=pizza.audio?8:0, trans=pizza.trans?T.transPrice:0;
  const total=(base+tok+audio+trans).toFixed(2);
  const key=pizza.tok+(pizza.audio?'1':'0')+(pizza.trans?'1':'0');
  const nm=PLAN_NAMES[key]||'MERIDIAN Custom';

  // Header badge
  set('valBadge', nm);

  // Row 1: Core
  set('vc_sess',  T.monthly);
  set('vc_perday',`Ã— ${T.daily}/×™×•×`);

  // Row 2: Tokens
  set('vt_tier',   T.name+' Tokens');
  set('vt_perSess',T.tokPerSess);
  set('vt_monthly',T.tokMonthly);
  set('vt_sessmo', T.monthly+' ×©××™×œ×ª×•×ª/×—×•×“×©');
  set('vt_price',  '+$'+T.price);
  setHTML('vt_badge',`<span class="val-add-badge">${T.badge}</span>`);

  // Row 3: Audio
  const aOn=pizza.audio;
  document.getElementById('vr_audio').className='val-row '+(aOn?'active':'inactive');
  set('va_perSess', T.audioMB);
  set('va_monthly', T.audioGB);
  set('va_files',   T.audioFiles+' ×§×‘×¦×™×/×—×•×“×©');
  set('va_price',   '+$8');
  document.getElementById('va_price').className='val-price'+(aOn?'':' inactive');
  setHTML('va_badge',`<span class="val-add-badge ${aOn?'':'off'}">${aOn?'×¤×¢×™×œ âœ“':'×œ× ×¤×¢×™×œ'}</span>`);

  // Row 4: Transcription
  const tOn=pizza.trans;
  document.getElementById('vr_trans').className='val-row '+(tOn?'active':'inactive');
  set('vtr_perSess', T.transMin+' ×“×§×•×ª');
  set('vtr_monthly', T.transMonthly);
  set('vtr_files',   T.monthly+' ×ª××œ×•×œ×™×/×—×•×“×©');
  set('vtr_price',   '+$'+T.transPrice);
  document.getElementById('vtr_price').className='val-price'+(tOn?'':' inactive');
  setHTML('vtr_badge',`<span class="val-add-badge ${tOn?'':'off'}">${tOn?'×¤×¢×™×œ âœ“':'×œ× ×¤×¢×™×œ'}</span>`);

  // Patients estimate row
  set('vp_calc',  `${T.daily} Ã— 22`);
  set('vp_total', T.monthly);
  set('vp_note',  `â‰ˆ ${T.daily} ××˜×•×¤×œ×™×/×™×•×\nÃ— 22 ×™××™ ×¢×‘×•×“×”`);

  // Total
  set('valTotal', '$'+total);
  set('totalDesc', `${T.monthly} ××¤×’×©×™×/×—×•×“×© Â· ${nm}`);

  pizza._total=total; pizza._name=nm;
}

// â”€â”€â”€ CONFIRM â†’ S4 â”€â”€â”€
function confirmPlan(){
  const nm=pizza._name||'MERIDIAN Starter';
  const tot=pizza._total||'27.90';
  set('s4ttl', `ğŸ‰ ${reg.first||'×‘×¨×•×š ×”×‘×'}, ×›××¢×˜ ×¡×™×™×× ×•!`);
  set('s4sub', `${nm} Â· $${tot}/×—×•×“×© Â· 14 ×™×•× × ×™×¡×™×•×Ÿ ×—×™× ×`);
  set('payNm', nm);
  setHTML('payPr',`$${tot}<span>/×—×•×“×©</span>`);
  set('loginNm',`${reg.first||''} ${reg.last||''}`);
  set('loginPl',`${nm} Â· $${tot}/×—×•×“×©`);
  const le=document.getElementById('loginEmail'); if(le) le.value=reg.email||'';
  if(supa&&reg.token){
    supa.from('meridian_leads').update({
      selected_tier:pizza.tok, addon_audio:pizza.audio, addon_trans:pizza.trans,
      plan_name:nm, monthly_price:'$'+tot, status:'plan_selected'
    }).eq('token',reg.token).then(()=>{}).catch(()=>{});
  }
  go('s4');
}

// â”€â”€â”€ PASSWORD VALIDATION â”€â”€â”€
function checkPass(){
  const p1=document.getElementById('loginPass');
  const p2=document.getElementById('loginPass2');
  const s=document.getElementById('pwStrength');
  const m=document.getElementById('pwMatch');
  if(!p1||!p2) return;
  const v1=p1.value, v2=p2.value;
  // Strength
  if(v1.length===0){ p1.className='linp'; s.className='pw-strength'; }
  else if(v1.length<8){ p1.className='linp error'; s.className='pw-strength show'; s.innerHTML='<span class="pw-err">âœ— × ×“×¨×© ×œ×¤×—×•×ª 8 ×ª×•×•×™× ('+v1.length+'/8)</span>'; }
  else { p1.className='linp valid'; s.className='pw-strength show'; s.innerHTML='<span class="pw-ok">âœ“ ×¡×™×¡××” ×ª×§×™× ×”</span>'; }
  // Match
  if(v2.length===0){ p2.className='linp'; m.className='pw-strength'; }
  else if(v1!==v2){ p2.className='linp error'; m.className='pw-strength show'; m.innerHTML='<span class="pw-err">âœ— ×”×¡×™×¡×××•×ª ××™× ×Ÿ ×ª×•×××•×ª</span>'; }
  else { p2.className='linp valid'; m.className='pw-strength show'; m.innerHTML='<span class="pw-ok">âœ“ ×”×¡×™×¡×××•×ª ×ª×•×××•×ª</span>'; }
}

// â”€â”€â”€ GROUP TIER â”€â”€â”€
function callGroup(){
  alert('ğŸ“ ×”×ª×§×©×¨ ×œ××‘×©×™ ×¡×¤×™×¨\n050-XXXXXXX\n\n×× ×—× ×• ×‘×•× ×™× ×™×—×“ ×ª×•×›× ×™×ª ×§×œ×™× ×™×§×” ××•×ª×××ª ××™×©×™×ª ×œ×§×‘×•×¦×” ×©×œ×š.');
}
function waGroup(){
  const msg=`×©×œ×•× ××‘×©×™! ğŸ‘‹\n×× ×™ ××¢×•× ×™×™×Ÿ ×‘×ª×•×›× ×™×ª MERIDIAN ×§×‘×•×¦×ª×™×ª ×œ×§×œ×™× ×™×§×” ×©×œ×™.\n\n×©×: ${reg.first||'â€”'} ${reg.last||''}\n×§×œ×™× ×™×§×”: ${reg.clinic||'â€”'}\n××˜×¤×œ×™×: ${reg.size||'â€”'}\n\n××©××— ×œ×¤×¨×˜×™× ×•××—×™×¨ ğŸ™`;
  window.open('https://wa.me/'+WA+'?text='+encodeURIComponent(msg),'_blank');
}

// â”€â”€â”€ DEMOS â”€â”€â”€
function demoPayment(){
  alert('âœ… DEMO\n×‘×©×œ×‘ P3 ×›××Ÿ ×™×”×™×” ×—×™×‘×•×¨ ×××™×ª×™ ×œ-Stripe.\n×‘×™× ×ª×™×™× â€” ×¦×•×¨ ×—×©×‘×•×Ÿ + ×©×œ×— WhatsApp ×œ××™×©×•×¨ ×™×“× ×™.');
}
function demoLogin(){
  const e=document.getElementById('loginEmail').value;
  const p=document.getElementById('loginPass').value;
  if(!e||!p){alert('× × ××œ× ××™××™×™×œ ×•×¡×™×¡××”');return;}
  if(p.length<8){alert('×¡×™×¡××” â€” ×œ×¤×—×•×ª 8 ×ª×•×•×™×');return;}
  const pl=document.getElementById('loginPl').textContent;
  alert(`âœ… DEMO\n${reg.first||'××˜×¤×œ'} â€” ×”×—×©×‘×•×Ÿ × ×•×¦×¨!\nğŸ“§ ${e}\nâ˜¯ ${pl}\n\n×‘-P3: Supabase Auth â†’ ×›× ×™×¡×” ×œ-CRM.`);
}

// â”€â”€â”€ INIT â”€â”€â”€
upTable();
</script>
</body>
</html>